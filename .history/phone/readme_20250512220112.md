# 国内空号生成工具需求文档

## 一、项目概述

### 1.1 背景介绍

在电话营销测试、系统开发、应用程序测试等场景中，常需要使用大量有效格式但实际未被分配使用的电话号码（即"空号"）。本工具旨在便捷地生成符合中国大陆电信运营商号码规则的空号，满足各类测试和开发需求。

### 1.2 项目目标

开发一个高效、准确的空号生成工具，能够批量生成随机且唯一的国内手机空号，供各类测试和开发场景使用。

## 二、功能需求

### 2.1 核心功能

- **随机生成**：生成符合中国大陆手机号码格式的电话号码，保证随机性
- **空号保证**：确保生成的号码为未被实际使用的"空号"
- **唯一性**：生成的号码不重复
- **批量生成**：支持一次性生成指定数量的空号
- **数据持久化**：支持将生成的空号保存到文件或数据库

### 2.2 用户交互

- **命令行界面**：支持通过命令行参数控制生成行为
- **图形界面**：提供简洁的 WEB 界面，方便用户操作
- **API 接口**：提供 HTTP API，便于系统集成

### 2.3 输入参数

- **数量**：需要生成的空号数量（1-100,000）
- **运营商选择**：可指定生成特定运营商的号码（移动、联通、电信或全部）
- **地区选择**：可选择特定省份或城市的号码归属地
- **前缀限制**：可指定号码前几位数字
- **特殊号码模式**：支持指定特定数字组合（如尾号、连续数字等）
- **输出格式**：文本文件、CSV、Excel、JSON 等

### 2.4 输出内容

- **号码列表**：生成的空号清单
- **元信息**：包含运营商、归属地等信息
- **统计信息**：生成的号码分布统计
- **生成报告**：包含生成时间、参数设置、成功率等信息

## 三、空号生成技术方案

### 3.1 号码规则库

- **运营商号段**：
  - 移动：134-139, 147-149, 150-152, 157-159, 165, 172, 178, 182-184, 187-188, 195-198，etc.
  - 联通：130-132, 145-146, 155-156, 166, 167, 171, 175-176, 185-186, 196, etc.
  - 电信：133, 149, 153, 173-174, 177, 180-181, 189, 190-193, 199, etc.
- **号段更新机制**：定期从工信部或其他可靠来源更新最新号段分配信息

### 3.2 空号判定策略

- **号段筛选**：基于最新的号段分配信息，避开已知分配的号段
- **在线验证集成**（可选）：集成第三方空号检测 API 进行双重验证
- **特殊号码规避**：避开 400、800 等特殊服务号码
- **规律号码处理**：针对 AAAA、ABCD 等规律性号码有特殊处理策略

### 3.3 确保唯一性的方法

- **内存数据结构**：使用哈希表或布隆过滤器存储已生成号码，保证高效查重
- **数据库支持**：大规模生成时使用数据库存储已生成号码
- **分布式唯一 ID**：可选实现分布式环境下的唯一性保证机制

### 3.4 随机算法优化

- **高质量随机源**：使用密码学安全的随机数生成器
- **权重随机**：根据号段使用频率设置权重，使生成结果更符合实际分布
- **批量预生成**：采用批量生成+过滤的策略提高效率

## 四、系统架构设计

### 4.1 模块组成

- **配置管理模块**：管理系统配置和号段规则库
- **号码生成引擎**：核心随机号码生成逻辑
- **空号验证模块**：验证生成号码的空号特性
- **唯一性检查模块**：确保生成号码不重复
- **存储模块**：负责数据持久化和历史查询
- **接口模块**：提供命令行、GUI 和 API 接口
- **报告模块**：生成统计报告和可视化结果

### 4.2 数据流程

1. 接收并解析用户输入的参数
2. 根据参数加载相应的号段规则
3. 基于规则随机生成候选号码
4. 验证候选号码是否符合空号条件
5. 检查候选号码是否与已生成号码重复
6. 通过验证的号码添加到结果集
7. 格式化并输出/保存结果

## 五、接口设计

### 5.1 命令行接口

```
phone-gen --count 100 --operator mobile --region beijing --output csv --path ./output.csv
```

### 5.2 函数接口

```python
def generate_empty_numbers(
    count=100,
    operator="all",
    region=None,
    prefix=None,
    pattern=None,
    output_format="text"
):
    """
    生成指定数量的空号

    参数:
    count (int): 生成的空号数量
    operator (str): 运营商类型 ("all", "mobile", "unicom", "telecom")
    region (str): 归属地区域 (省份或城市名称)
    prefix (str): 指定号码前缀
    pattern (dict): 特殊号码模式 (如: {"tail": "8888", "exclude": ["4"]})
    output_format (str): 输出格式 ("text", "csv", "excel", "json")

    返回:
    dict: {
        "numbers": [...], // 生成的号码列表
        "metadata": {...}, // 元数据信息
        "statistics": {...} // 统计信息
    }
    """
```

### 5.3 Web API 接口

- **POST /api/generate**：生成空号
  ```json
  {
    "count": 100,
    "operator": "mobile",
    "region": "beijing",
    "prefix": "138",
    "pattern": { "exclude": ["4"] },
    "output_format": "json"
  }
  ```
- **GET /api/history**：查询历史生成记录
- **GET /api/stats**：获取使用统计信息

## 六、性能与安全指标

### 6.1 性能指标

- **生成速度**：单核 CPU 下每秒生成至少 1,000 个空号
- **内存效率**：生成 100,000 个号码时内存占用不超过 500MB
- **响应时间**：API 接口平均响应时间小于 200ms（1,000 个号码以内）

### 6.2 安全保障

- **接口认证**：Web API 提供密钥认证机制
- **访问限制**：防止滥用的速率限制
- **日志审计**：记录所有生成操作，便于追溯
- **数据安全**：敏感配置加密存储

## 七、实现技术选型

### 7.1 开发语言与框架

- **核心引擎**：Python 3.8+
- **Web 框架**：FastAPI/Flask
- **前端界面**：Vue.js + Element UI
- **数据存储**：SQLite (轻量版) / PostgreSQL (企业版)

### 7.2 部署方案

- **单机部署**：支持 Windows/Linux/macOS 下的本地运行
- **Docker 容器**：提供容器化部署方案
- **云服务部署**：支持在主流云平台部署

## 八、使用场景示例

### 8.1 测试场景

- **批量生成 1000 个移动号码用于系统导入测试**
  ```
  phone-gen --count 1000 --operator mobile --output excel
  ```

### 8.2 开发场景

- **生成特定区域的电信号码用于功能开发**
  ```
  phone-gen --count 50 --operator telecom --region shanghai --output json
  ```

### 8.3 特殊需求

- **生成带有特定尾号的联通号码**
  ```
  phone-gen --count 20 --operator unicom --pattern '{"tail": "9999"}' --output csv
  ```

## 九、注意事项与免责声明

- 本工具生成的号码仅供系统测试、开发学习等合法用途
- 由于运营商号段分配信息可能不完全公开，无法 100%保证生成的号码为空号
- 严禁将本工具用于骚扰电话、诈骗等违法行为
- 使用本工具生成的数据进行测试时，建议在封闭测试环境中进行
- 建议定期更新号段规则库，以提高空号判定的准确性

## 十、后续扩展计划

### 10.1 近期计划

- 支持国际电话号码格式
- 增加更多自定义号码生成规则
- 优化空号判定准确率

### 10.2 中长期规划

- 提供企业级 API 服务
- 支持更多号码类型（如：固定电话、虚拟运营商等）
- 开发插件系统支持自定义扩展

---

_本文档将随项目进展不断更新，最终实现可能会根据实际情况做相应调整。_
